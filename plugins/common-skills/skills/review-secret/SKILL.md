---
name: review-secret
description: push前にシークレット情報や個人情報の漏洩がないかチェックする
disable-model-invocation: true
allowed-tools: Bash, Read, Grep, Glob
---

リポジトリ内のファイルを走査し、push してはいけない情報が含まれていないかチェックしてください。

## チェック対象

### 1. シークレット情報
以下のパターンに一致する**実際の値**がないか確認する（プレースホルダーや説明用のダミー値は OK）:

- API トークン（`ghp_`, `gho_`, `github_pat_`, `xoxb-`, `xoxp-`, `sk-`, `sk_live_` 等）
- パスワード・シークレットキーのハードコード
- `.env` ファイルの実体
- 秘密鍵ファイル（`*.pem`, `*.key`, `id_rsa` 等）

### 2. 個人情報
- メールアドレス（プレースホルダーでないもの）
- 個人名・ユーザー名のハードコード
- 内部 URL やイントラネットアドレス

### 3. MCP 設定
- `.mcp.json` 内にシークレットが直接記述されていないか
- 環境変数プレースホルダー（`${...}`）になっているか確認

### 4. .gitignore の確認
- シークレットを含みうるファイル（`.env`, `secrets/` 等）が除外されているか

## 実行手順

1. `git status` で変更ファイルと未追跡ファイルを確認
2. 上記パターンで `grep` を実行
3. `.gitignore` の内容を確認
4. `.mcp.json` ファイルを個別チェック

## 出力フォーマット

```
【チェック結果】

状態: OK / NG

【検出項目】（問題がある場合のみ）
- ファイル名:行番号 - 問題の内容

【確認済み項目】
- シークレット情報: OK / NG
- 個人情報: OK / NG
- MCP 設定: OK / NG
- .gitignore: OK / NG

【推奨アクション】（問題がある場合のみ）
- 修正すべき内容の説明
```
